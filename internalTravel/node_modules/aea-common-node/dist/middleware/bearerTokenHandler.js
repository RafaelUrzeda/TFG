"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkBearerScope = void 0;
const checkBearerScope = (scope, excludes = []) => {
    return (req, res, done) => {
        const route = req.routeOptions.url?.valueOf() || "";
        if (![...excludes, "/health"].includes(route)) {
            if (!req.jwt.scp.includes(scope)) {
                return res.status(401).send({
                    errorCode: "Unauthorized",
                    errorDescription: "Invalid Scope",
                });
            }
        }
        done();
    };
};
exports.checkBearerScope = checkBearerScope;
