"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkBasicToken = void 0;
const checkBasicToken = (basic, excludes = []) => {
    return (req, res, done) => {
        const route = req.routeOptions.url?.valueOf() || "";
        if (![...excludes, "/health"].includes(route)) {
            if (req.headers.authorization !== basic) {
                return res.status(401).send({
                    errorCode: "Unauthorized",
                    errorDescription: "Invalid Basic",
                });
            }
        }
        done();
    };
};
exports.checkBasicToken = checkBasicToken;
